---
title: "Indicadores no R indicadores de outras formas de trabalho na PNADC anual"
author: "Italo Mendonça"
date: "27-novembro-2024"
output:
   bookdown::html_document2:
    toc: true
    toc_float: true
    number_sections: true
    df_print: kable
    fig_caption: TRUE
editor_options:
  markdown:
    wrap: 72
bibliography: references.bib
csl: associacao-brasileira-de-normas-tecnicas-ufrgs.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)  # Esta linha de código é usada para definir opções globais para todos os trechos de código (chunks) encontrados no documento. o argumento "echo = TRUE" indica que o código contido em cada chunk deve ser exibido no documento final gerado a partir do arquivo R Markdown. Ou seja, quando o documento for renderizado (convertido para um formato final como PDF, HTML, etc.), o código R que foi escrito dentro de cada chunk aparecerá ao lado dos resultados de sua execução.
```

O objetivo deste tutorial é extrair os dados amostrais da PNADC anual de
outras formas de trabalho com auxílio do pacote PNADcIBGE [@PNADcIBGE].

# Pergunta orientadora

Qual a quantidde de Pessoas de 14 anos ou mais de idade, na força de
trabalho, na semana de referência, por sexo?

# Base de dados e conferência dos dados

Os dados necessários para responder a pergunta proposta estão presentes
na quinta visita da PNADC.

```{r dados, echo=TRUE, warning=FALSE}
# carrega as bibliotecas
library(PNADcIBGE) # Carrega o pacote PNADcIBGE
library(survey) # Carrega o pacote survey
library(dplyr) # Carrega o pacote dplyr
library(knitr) # Carrega o pacote knitr

# definição de variáveis - cria um vetor com as variáveis que serão importadas da PNADc
variaveis_selecionadas <- c(
  "UF",
  "VD4001",
  "VD4002",
  "V4013",
  "VD4020",
  "VD3005",
  "V4012",
  "V2007",
  "V2010",
  "V2009",
  "VD4039",
  "VD3004",
  "VD4035"
)

# importando os dados do servidor do IBGE
dadosPNADc <- get_pnadc(year = 2022,
                        interview = 5,
                        vars = variaveis_selecionadas)


options(survey.lonely.psu = "adjust", encoding="UTF-8")

# Opção de vizualização de números
# A linha de código a seguir instrui o ambiente a evitar a notação científica ao
# imprimir números. Isso significa que números muito grandes ou muito pequenos
# serão exibidos na sua forma completa, sem a utilização do formato exponencial
# (como 1e+10 ou 1e-10).
options(scipen = 999)

# modifica e cria variáveis
dadosPNADc$variables <- dadosPNADc$variables %>%
  mutate(
    one = 1,
    ocupados = 1 * (
      VD4002 == "Pessoas ocupadas"
    ),
     desocupados = 1 * (
      VD4002 == "Pessoas desocupadas"
    ),
    raca_cor = case_when(
      V2010 == "Preta" | V2010 == "Parda" ~ "Preta ou parda",
      V2010 == "Amarela"  |
        V2010 == "Indígena" | V2010 == "Ignorado" ~ "Outras",
      V2010 == "Branca" ~ "Branca"
    ),
    faixa_idade = case_when((V2009 >= 14 &
                               V2009 <= 29) ~ "0De14a29anos",
                            (V2009 >= 30 &
                               V2009 <= 44) ~ "de30a44anos",
                            (V2009 >= 45 &
                               V2009 <= 59) ~ "de45a59anos",
                            (V2009 >= 60) ~ "de60a+anos"
    ),
    estratos_geogr = case_when((
      Estrato == "3110213" |
        Estrato == "3110113" |
        Estrato == "3110112" |
        Estrato == "3110212" |
        Estrato == "3110111" |
        Estrato == "3110211"
    ) ~ "01-Belo Horizonte",
    (
      Estrato == "3120011" |
        Estrato == "3120013" |
        Estrato == "3120020" |
        Estrato == "3120012"
    ) ~ "02-Entorno metropolitono de BH",
    (Estrato == "3130011" |
       Estrato == "3130012" |
       Estrato == "3130020") ~ "03-Colar metropolitano de BH",
    (Estrato == "3140010" |
       Estrato == "3140020") ~ "04-RIDE de Brasília em Minas",
    (
      Estrato == "3151011" |
        Estrato == "3151012" |
        Estrato == "3151013" |
        Estrato == "3151021" |
        Estrato == "3151022" |
        Estrato == "3151023"
    ) ~ "05-Sul de Minas",
    (
      Estrato == "3152011" |
        Estrato == "3152012" |
        Estrato == "3152013" |
        Estrato == "3152021" |
        Estrato == "3152022"
    ) ~ "06-Triângulo Mineiro",
    (
      Estrato == "3153011" |
        Estrato == "3153012" |
        Estrato == "3153013" |
        Estrato == "3153021" |
        Estrato == "3153022" |
        Estrato == "3153023"
    ) ~ "07-Mata de Minas Gerais",
    (
      Estrato == "3154011" |
        Estrato == "3154012" |
        Estrato == "3154013" |
        Estrato == "3154021" |
        Estrato == "3154022" |
        Estrato == "3154023"
    ) ~ "08-Norte de Minas",
    (
      Estrato == "3155011" |
        Estrato == "3155012" |
        Estrato == "3155013" |
        Estrato == "3155021" |
        Estrato == "3155022" |
        Estrato == "3155023"
    ) ~ "09-Vale do Rio Doce",
    (
      Estrato == "3156011" |
        Estrato == "3156012" |
        Estrato == "3156013" |
        Estrato == "3156021" |
        Estrato == "3156022"
    ) ~ "10-Central"
    )
  )


```

#POPULAÇÃO OCUPADA, DESAGREGAÇÃO POR SEXO NOS ESTRATOS GEOGRÁFICOS

#ESTATÍSTICA PARA MULHERES

Qual a quantidade de mulheres de 14 anos ou mais de idade, ocupadas, na
semana de referência, por estrato geográfico?

```{r}
t.ocup.sexoM <- svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Mulher"), svytotal, na.rm=TRUE)


knitr::kable(t.ocup.sexoM,
             caption = "Mulheres de 14 anos ou mais de idade, ocupadas, na semana de referência - Minas Gerais - 2022")
```

Coeficiente de variação

```{r}
cv.t.ocup.sexoM <- round(cv(svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Mulher"), svytotal, na.rm=TRUE))*100,1)

knitr::kable(cv.t.ocup.sexoM,
             caption = "Coeficiente Variação - Total Mulheres de 14 anos ou mais de idade, ocupadas, na semana de referência - Minas Gerais - 2022")
```

Qual a proporção de mulheres de 14 anos ou mais de idade, ocupadas, na
semana de referência, por estrato geográfico?

```{r}
p.ocup.sexoM <- svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Mulher"), svymean, na.rm=TRUE)


knitr::kable(p.ocup.sexoM,
             caption = "Mulheres de 14 anos ou mais de idade, ocupadas, na semana de referência - Minas Gerais - 2022")
```

Coeficiente de variação

```{r}
cv.p.ocup.sexoM <- round(cv(svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Mulher"), svymean, na.rm=TRUE))*100,1)

knitr::kable(cv.p.ocup.sexoM,
             caption = "Coeficiente Variação - Proporção Mulheres de 14 anos ou mais de idade, ocupadas, na semana de referência - Minas Gerais - 2022")
```

  
#ESTATÍSTICA PARA HOMENS


Qual a quantidade de homens de 14 anos ou mais de idade, ocupados, na
semana de referência?

```{r}
t.ocup.sexoH <- svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Homem"), svytotal, na.rm=TRUE)


knitr::kable(t.ocup.sexoH,
             caption = "Homens de 14 anos ou mais de idade, ocupados, na semana de referência - Minas Gerais - 2022")
```

```{r}
cv.t.ocup.sexoH <- round(cv(svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Homem"), svytotal, na.rm=TRUE))*100,1)

knitr::kable(cv.t.ocup.sexoH,
             caption = "Coeficiente Variação - Total Homens de 14 anos ou mais de idade, ocupados, na semana de referência - Minas Gerais - 2022")
```

Qual a proporção de homens de 14 anos ou mais de idade, ocupados, na
semana de referência?

```{r}
p.ocup.sexoH <- svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Homem"), svymean, na.rm=TRUE)


knitr::kable(p.ocup.sexoH,
             caption = "Homens de 14 anos ou mais de idade, ocupados, na semana de referência - Minas Gerais - 2022")
```

Coeficiente de variação

```{r}
cv.p.ocup.sexoH <- round(cv(svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Homem"), svymean, na.rm=TRUE))*100,1)

knitr::kable(cv.p.ocup.sexoH,
             caption = "Coeficiente Variação - Proporção Homens de 14 anos ou mais de idade, ocupados, na semana de referência - Minas Gerais - 2022")
```

#POPULAÇÃO DESOCUPADA, DESAGREGAÇÃO POR SEXO NOS ESTRATOS GEOGRÁFICOS

Qual o total de pessoas de 14 anos ou mais de idade, ocupadas e
desocupadas, na semana de referência, por estrato geográfico e por sexo?

```{r}

t.desocup.sexo <- svytotal(x=~interaction(desocupados, V2007, estratos_geogr), subset(dadosPNADc,UF=="Minas Gerais"), na.rm=TRUE)


knitr::kable(t.desocup.sexo,
             caption = "Ocupados e Desocupados com 14 anos ou mais de idade, por sexo, na semana de referência - Minas Gerais - 2022")
```

Qual a proporção de pessoas de 14 anos ou mais de idade, ocupadas e
desocupadas, na semana de referência, por estrato geográfico e por sexo?

```{r}

p.desocup.sexo <- svymean(x=~interaction(desocupados, V2007, estratos_geogr), subset(dadosPNADc,UF=="Minas Gerais"), na.rm=TRUE)


knitr::kable(p.desocup.sexo,
             caption = "Ocupados e Desocupados com 14 anos ou mais de idade, por sexo, na semana de referência - Minas Gerais - 2022")
```

# Total de ocupados por idade, sexo e raça ou cor

```{r}
t.ocup.idade.sexo.racacor <- coef(svyby(~ ocupados,by = ~faixa_idade+V2007+raca_cor+estratos_geogr, subset(dadosPNADc,UF=="Minas Gerais"), svytotal,na.rm = TRUE))
t.ocup.idade.sexo.racacor
```

# Total de desocupados por idade, sexo e raça ou cor, nos estratos geográficos de Minas Gerais

```{r}
t.desocup.idade.sexo.racacor <- coef(svyby(~ desocupados,by = ~faixa_idade+V2007+raca_cor+estratos_geogr, subset(dadosPNADc,UF=="Minas Gerais"), svytotal,na.rm = TRUE))
t.desocup.idade.sexo.racacor
```

# Taxa de desocupação nos estratos geográficos de Minas Gerais

```{r}
txdesocup <- svyby(formula=~(VD4002=="Pessoas desocupadas"), denominator=~(VD4001=="Pessoas na força de trabalho"), by=~interaction(estratos_geogr), design=dadosPNADc, FUN=svyratio, vartype="cv", na.rm=TRUE)


knitr::kable(txdesocup,
             caption = "taxa de desocupação para os estratos geográficos - Minas Gerais - 2022")
```

# Taxa de desocupação nos estratos geográficos de Minas Gerais, para os homens

```{r}
txdesocupH <- svyby(formula=~(VD4002=="Pessoas desocupadas"), denominator=~(VD4001=="Pessoas na força de trabalho"), by=~interaction(estratos_geogr), design=subset(dadosPNADc, V2007=="Homem"), FUN=svyratio, vartype="cv", na.rm=TRUE)


knitr::kable(txdesocupH,
             caption = "taxa de desocupação, homens, para os estratos geográficos - Minas Gerais - 2022")
```

# Taxa de desocupação nos estratos geograficos de Minas Gerais, para as mulheres

```{r}
txdesocupM <- svyby(formula=~(VD4002=="Pessoas desocupadas"), denominator=~(VD4001=="Pessoas na força de trabalho"), by=~interaction(estratos_geogr), design=subset(dadosPNADc, V2007=="Mulher"), FUN=svyratio, vartype="cv", na.rm=TRUE)


knitr::kable(txdesocupM,
             caption = "taxa de desocupacao, mulheres, para os estratos geograficos - Minas Gerais - 2022")
```

# Taxa de desocupação nos estratos geográficos de Minas Gerais, para brancos

```{r}
txdesocupB <- svyby(formula=~(VD4002=="Pessoas desocupadas"), denominator=~(VD4001=="Pessoas na força de trabalho"), by=~interaction(estratos_geogr), design=subset(dadosPNADc, raca_cor=="Branca"), FUN=svyratio, vartype="cv", na.rm=TRUE)


knitr::kable(txdesocupB,
             caption = "taxa de desocupação, brancos, para os estratos geográficos - Minas Gerais - 2022")
```

# Taxa de desocupação nos estratos geográficos de Minas Gerais, para Pretos ou Pardos

```{r}
txdesocupP <- svyby(formula=~(VD4002=="Pessoas desocupadas"), denominator=~(VD4001=="Pessoas na força de trabalho"), by=~interaction(estratos_geogr), design=subset(dadosPNADc, raca_cor=="Preta ou parda"), FUN=svyratio, vartype="cv", na.rm=TRUE)


knitr::kable(txdesocupP,
             caption = "taxa de desocupação, Pretos ou Pardos , para os estratos geográficos - Minas Gerais - 2022")
```

# Taxa de desocupação nos estratos geográficos de Minas Gerais, para pessoas com 14 a 29 anos

```{r}
txdesocupJ <- svyby(formula=~(VD4002=="Pessoas desocupadas"), denominator=~(VD4001=="Pessoas na força de trabalho"), by=~interaction(estratos_geogr), design=subset(dadosPNADc, faixa_idade=="0De14a29anos"), FUN=svyratio, vartype="cv", na.rm=TRUE)


knitr::kable(txdesocupJ,
             caption = "taxa de desocupação, pessoas com 14 a 29 anos , para os estratos geográficos - Minas Gerais - 2022")
```

# Taxa de desocupação nos estratos geográficos de Minas Gerais, para pessoas com 30 a 44 anos

```{r}
txdesocupA <- svyby(formula=~(VD4002=="Pessoas desocupadas"), denominator=~(VD4001=="Pessoas na força de trabalho"), by=~interaction(estratos_geogr), design=subset(dadosPNADc, faixa_idade=="de30a44anos"), FUN=svyratio, vartype="cv", na.rm=TRUE)


knitr::kable(txdesocupA,
             caption = "taxa de desocupação, pessoas com 30 a 44 anos , para os estratos geográficos - Minas Gerais - 2022")
```

# Taxa de desocupação nos estratos geográficos de Minas Gerais, para pessoas com 45 a 59 anos

```{r}
txdesocupAA <- svyby(formula=~(VD4002=="Pessoas desocupadas"), denominator=~(VD4001=="Pessoas na força de trabalho"), by=~interaction(estratos_geogr), design=subset(dadosPNADc, faixa_idade=="de45a59anos"), FUN=svyratio, vartype="cv", na.rm=TRUE)


knitr::kable(txdesocupAA,
             caption = "taxa de desocupação, pessoas com 45 a 59 anos , para os estratos geográficos - Minas Gerais - 2022")
```

# Taxa de desocupação nos estratos geográficos de Minas Gerais, para pessoas acima de 60 anos

```{r}
txdesocupI <- svyby(formula=~(VD4002=="Pessoas desocupadas"), denominator=~(VD4001=="Pessoas na força de trabalho"), by=~interaction(estratos_geogr), design=subset(dadosPNADc, faixa_idade=="de60a+anos"), FUN=svyratio, vartype="cv", na.rm=TRUE)


knitr::kable(txdesocupI,
             caption = "taxa de desocupação, pessoas acima de 60 anos , para os estratos geográficos - Minas Gerais - 2022")
```

