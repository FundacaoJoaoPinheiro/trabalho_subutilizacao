---
title: "Indicadores no R indicadores de outras formas de trabalho na PNADC anual"
author: "Italo Mendonça"
date: "27-novembro-2024"
output:
   bookdown::html_document2:
    toc: true
    toc_float: true
    number_sections: true
    df_print: kable
    fig_caption: TRUE
editor_options:
  markdown:
    wrap: 72
bibliography: references.bib
csl: associacao-brasileira-de-normas-tecnicas-ufrgs.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)  # Esta linha de código é usada para definir opções globais para todos os trechos de código (chunks) encontrados no documento. o argumento "echo = TRUE" indica que o código contido em cada chunk deve ser exibido no documento final gerado a partir do arquivo R Markdown. Ou seja, quando o documento for renderizado (convertido para um formato final como PDF, HTML, etc.), o código R que foi escrito dentro de cada chunk aparecerá ao lado dos resultados de sua execução.
```

O objetivo deste tutorial é extrair os dados amostrais da PNADC anual de
outras formas de trabalho com auxílio do pacote PNADcIBGE [@PNADcIBGE].

# Pergunta orientadora

Qual a quantidde de Pessoas de 14 anos ou mais de idade, na força de
trabalho, na semana de referência, por sexo?

# Base de dados e conferência dos dados

Os dados necessários para responder a pergunta proposta estão presentes
na quinta visita da PNADC.

```{r dados, echo=TRUE, warning=FALSE}
# carrega as bibliotecas
library(PNADcIBGE) # Carrega o pacote PNADcIBGE
library(survey) # Carrega o pacote survey
library(dplyr) # Carrega o pacote dplyr
library(knitr) # Carrega o pacote knitr

# definição de variáveis - cria um vetor com as variáveis que serão importadas da PNADc
variaveis_selecionadas <- c(
  "UF",
  "VD4001",
  "VD4002",
  "V4013",
  "VD4020",
  "VD3005",
  "V4012",
  "V2007",
  "V2010",
  "V2009",
  "VD4039",
  "VD4009",
  "VD3004",
  "V4019",
  "VD4035"
)

# importando os dados do servidor do IBGE
dadosPNADc <- get_pnadc(year = 2022,
                        interview = 5,
                        vars = variaveis_selecionadas)


options(survey.lonely.psu = "adjust", encoding="UTF-8")

# Opção de vizualização de números
# A linha de código a seguir instrui o ambiente a evitar a notação científica ao
# imprimir números. Isso significa que números muito grandes ou muito pequenos
# serão exibidos na sua forma completa, sem a utilização do formato exponencial
# (como 1e+10 ou 1e-10).
options(scipen = 999)

# modifica e cria variáveis
dadosPNADc$variables <- dadosPNADc$variables %>%
  mutate(
    one = 1,
    ocupados = 1 * (
      VD4002 == "Pessoas ocupadas"
    ),
     desocupados = 1 * (
      VD4002 == "Pessoas desocupadas"
    ),
    fora_forca = 1 * (
      VD4001 == "Pessoas fora da força de trabalho"
    ),
informais = case_when(
  VD4009 == "Empregado no setor privado sem carteira de trabalho assinada" |
    VD4009 == "Trabalhador doméstico sem carteira de trabalho assinada" |
    VD4009 == "Empregado no setor público sem carteira de trabalho assinada" |
    VD4009 == "Trabalhador familiar auxiliar" ~ "Informais",
),
    raca_cor = case_when(
      V2010 == "Preta" | V2010 == "Parda" ~ "Preta ou parda",
      V2010 == "Amarela"  |
        V2010 == "Indígena" | V2010 == "Ignorado" ~ "Outras",
      V2010 == "Branca" ~ "Branca"
    ),
    faixa_idade = case_when((V2009 >= 14 &
                               V2009 <= 29) ~ "0De14a29anos",
                            (V2009 >= 30 &
                               V2009 <= 44) ~ "de30a44anos",
                            (V2009 >= 45 &
                               V2009 <= 59) ~ "de45a59anos",
                            (V2009 >= 60) ~ "de60a+anos"
    ),
    estratos_geogr = case_when((
      Estrato == "3110213" |
        Estrato == "3110113" |
        Estrato == "3110112" |
        Estrato == "3110212" |
        Estrato == "3110111" |
        Estrato == "3110211"
    ) ~ "01-Belo Horizonte",
    (
      Estrato == "3120011" |
        Estrato == "3120013" |
        Estrato == "3120020" |
        Estrato == "3120012"
    ) ~ "02-Entorno metropolitono de BH",
    (Estrato == "3130011" |
       Estrato == "3130012" |
       Estrato == "3130020") ~ "03-Colar metropolitano de BH",
    (Estrato == "3140010" |
       Estrato == "3140020") ~ "04-RIDE de Brasília em Minas",
    (
      Estrato == "3151011" |
        Estrato == "3151012" |
        Estrato == "3151013" |
        Estrato == "3151021" |
        Estrato == "3151022" |
        Estrato == "3151023"
    ) ~ "05-Sul de Minas",
    (
      Estrato == "3152011" |
        Estrato == "3152012" |
        Estrato == "3152013" |
        Estrato == "3152021" |
        Estrato == "3152022"
    ) ~ "06-Triângulo Mineiro",
    (
      Estrato == "3153011" |
        Estrato == "3153012" |
        Estrato == "3153013" |
        Estrato == "3153021" |
        Estrato == "3153022" |
        Estrato == "3153023"
    ) ~ "07-Mata de Minas Gerais",
    (
      Estrato == "3154011" |
        Estrato == "3154012" |
        Estrato == "3154013" |
        Estrato == "3154021" |
        Estrato == "3154022" |
        Estrato == "3154023"
    ) ~ "08-Norte de Minas",
    (
      Estrato == "3155011" |
        Estrato == "3155012" |
        Estrato == "3155013" |
        Estrato == "3155021" |
        Estrato == "3155022" |
        Estrato == "3155023"
    ) ~ "09-Vale do Rio Doce",
    (
      Estrato == "3156011" |
        Estrato == "3156012" |
        Estrato == "3156013" |
        Estrato == "3156021" |
        Estrato == "3156022"
    ) ~ "10-Central"
    )
  )


```

#POPULAÇÃO OCUPADA, DESAGREGAÇÃO POR SEXO NOS ESTRATOS GEOGRÁFICOS

#ESTATÍSTICA PARA MULHERES

Qual a quantidade de mulheres de 14 anos ou mais de idade, ocupadas, na
semana de referência, por estrato geográfico?

```{r}
t.ocup.sexoM <- svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Mulher"), svytotal, na.rm=TRUE)


knitr::kable(t.ocup.sexoM,
             caption = "Mulheres de 14 anos ou mais de idade, ocupadas, na semana de referência - Minas Gerais - 2022")
```

Coeficiente de variação

```{r}
cv.t.ocup.sexoM <- round(cv(svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Mulher"), svytotal, na.rm=TRUE))*100,1)

knitr::kable(cv.t.ocup.sexoM,
             caption = "Coeficiente Variação - Total Mulheres de 14 anos ou mais de idade, ocupadas, na semana de referência - Minas Gerais - 2022")
```

Qual a proporção de mulheres de 14 anos ou mais de idade, ocupadas, na
semana de referência, por estrato geográfico?

```{r}
p.ocup.sexoM <- svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Mulher"), svymean, na.rm=TRUE)


knitr::kable(p.ocup.sexoM,
             caption = "Mulheres de 14 anos ou mais de idade, ocupadas, na semana de referência - Minas Gerais - 2022")
```

Coeficiente de variação

```{r}
cv.p.ocup.sexoM <- round(cv(svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Mulher"), svymean, na.rm=TRUE))*100,1)

knitr::kable(cv.p.ocup.sexoM,
             caption = "Coeficiente Variação - Proporção Mulheres de 14 anos ou mais de idade, ocupadas, na semana de referência - Minas Gerais - 2022")
```

  
#ESTATÍSTICA PARA HOMENS


Qual a quantidade de homens de 14 anos ou mais de idade, ocupados, na
semana de referência?

```{r}
t.ocup.sexoH <- svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Homem"), svytotal, na.rm=TRUE)


knitr::kable(t.ocup.sexoH,
             caption = "Homens de 14 anos ou mais de idade, ocupados, na semana de referência - Minas Gerais - 2022")
```

```{r}
cv.t.ocup.sexoH <- round(cv(svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Homem"), svytotal, na.rm=TRUE))*100,1)

knitr::kable(cv.t.ocup.sexoH,
             caption = "Coeficiente Variação - Total Homens de 14 anos ou mais de idade, ocupados, na semana de referência - Minas Gerais - 2022")
```

Qual a proporção de homens de 14 anos ou mais de idade, ocupados, na
semana de referência?

```{r}
p.ocup.sexoH <- svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Homem"), svymean, na.rm=TRUE)


knitr::kable(p.ocup.sexoH,
             caption = "Homens de 14 anos ou mais de idade, ocupados, na semana de referência - Minas Gerais - 2022")
```

Coeficiente de variação

```{r}
cv.p.ocup.sexoH <- round(cv(svyby(~ocupados, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Homem"), svymean, na.rm=TRUE))*100,1)

knitr::kable(cv.p.ocup.sexoH,
             caption = "Coeficiente Variação - Proporção Homens de 14 anos ou mais de idade, ocupados, na semana de referência - Minas Gerais - 2022")
```

#POPULAÇÃO DESOCUPADA, DESAGREGAÇÃO POR SEXO NOS ESTRATOS GEOGRÁFICOS

Qual o total de pessoas de 14 anos ou mais de idade, ocupadas e
desocupadas, na semana de referência, por estrato geográfico e por sexo?

```{r}

t.desocup.sexo <- svytotal(x=~interaction(desocupados, V2007, estratos_geogr), subset(dadosPNADc,UF=="Minas Gerais"), na.rm=TRUE)


knitr::kable(t.desocup.sexo,
             caption = "Ocupados e Desocupados com 14 anos ou mais de idade, por sexo, na semana de referência - Minas Gerais - 2022")
```

Qual a proporção de pessoas de 14 anos ou mais de idade, ocupadas e
desocupadas, na semana de referência, por estrato geográfico e por sexo?

```{r}

p.desocup.sexo <- svymean(x=~interaction(desocupados, V2007, estratos_geogr), subset(dadosPNADc,UF=="Minas Gerais"), na.rm=TRUE)


knitr::kable(p.desocup.sexo,
             caption = "Ocupados e Desocupados com 14 anos ou mais de idade, por sexo, na semana de referência - Minas Gerais - 2022")
```

# PESSOAS FORA DA FORÇA DE TRABALHO, POR SEXO

#ESTATÍSTICA PARA MULHERES

Qual a quantidade de mulheres de 14 anos ou mais de idade, fora da força de trabalho, na
semana de referência, por estrato geográfico?

```{r}
t.foraforca.sexoM <- svyby(~fora_forca, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Mulher"), svytotal, na.rm=TRUE)


knitr::kable(t.foraforca.sexoM,
             caption = "Mulheres de 14 anos ou mais de idade, fora da força de trabalho - Minas Gerais - 2022")
```

Coeficiente de variação

```{r}
cv.t.foraforca.sexoM<- round(cv(svyby(~fora_forca, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Mulher"), svytotal, na.rm=TRUE))*100,1)

knitr::kable(cv.t.foraforca.sexoM,
             caption = "Coeficiente Variação - Mulheres de 14 anos ou mais de idade, fora da força de trabalho - Minas Gerais - 2022")
```

Qual a proporção de mulheres de 14 anos ou mais de idade, fora da força de trabalho, na
semana de referência, por estrato geográfico?

```{r}
p.foraforca.sexoM <- svyby(~fora_forca, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Mulher"), svymean, na.rm=TRUE)


knitr::kable(p.foraforca.sexoM,
             caption = "Mulheres de 14 anos ou mais de idade, fora da força de trabalho - Minas Gerais - 2022")
```

Coeficiente de variação

```{r}
cv.p.foraforca.sexoM<- round(cv(svyby(~fora_forca, by = ~estratos_geogr, subset(dadosPNADc, V2007=="Mulher"), svymean, na.rm=TRUE))*100,1)

knitr::kable(cv.p.foraforca.sexoM,
             caption = "Coeficiente Variação - Proporção Mulheres de 14 anos ou mais de idade, fora da força de trabalho - Minas Gerais - 2022")
```

#Calculando a taxa de informalidade

```{r}
txinformalidade <- svyby(formula=~(informais=="Informais"), denominator=~(VD4002=="Pessoas ocupadas"), by=~estratos_geogr, subset(dadosPNADc,UF=="Minas Gerais"), FUN=svymean, vartype="cv", na.rm=TRUE)

knitr::kable(txinformalidade,
             caption = "Taxa de informalidade, por estratos geográficos - Minas Gerais - 2022")
```



